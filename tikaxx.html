<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Integra Form</title> <!-- Include Signature Pad library -->
   <script src="https://cdnjs.cloudflare.com/ajax/libs/signature_pad/1.5.3/signature_pad.min.js"></script>
   <style>
      #signature-pad {
          border: 1px solid #ccc;
          width: 100%;
          max-width: 400px;
          margin: 10px 0;
      }
      
      .signature-pad {
          position: relative;
      }
      
      .signature-pad canvas {
          border: 1px solid #ccc;
          width: 100%;
          max-width: 100%;
      }
      		.center {
        margin: auto;
        width: 70%;
      
      }
      div.a {
        text-align: center;
      }
      div.a1 {
        text-align: center;
        color:#1b294e;
        font-size:30px;
      }
      div.a2 {
        text-align: center;
        color:red;
        font-size:20px;
      }
      div.b2 {
        text-align: left;
        color:red;
        font-size:20px;
      }
      div.o {
        text-align: left;
        color:orange;
        font-size:14px;
      }
      div.b {
        text-align: left;
      }
      
      div.c {
        text-align: right;
      } 
      
      div.d {
        text-align: justify;
      } 
      .left{
        float:left;
        width: 50%;
       
      }
      select {
        width: 80%;
        padding: 16px 20px;
        border: none;
        border-radius: 4px;
        background-color: #f1f1f1;
      }
      input {
        width: 80%;
        padding: 16px 20px;
        border: none;
        border-radius: 4px;
        background-color: #f1f1f1;
      }
      textarea {
        width: 80%;
        padding: 16px 20px;
        border: none;
        border-radius: 4px;
        background-color: #f1f1f1;
      }
      input.s {
        width: 100%;
      color:orange;
      font-weight: bold;
      font-size:20px;
      }
      .mandatory__required {
          margin-left: 3px;
          color: red;
      }
      		.error-message {
          color: red;
          font-size: 14px;
      }
      		 
   </style>
</head>

<body> <img src="https://sftp.tika.mobi/ftp/1.jpg" style="width:100%;">
   <div class="center">
      <div class="b"> <br><br> <b>Integra</b><br> Pharmaceutical Diagnostics (PDx)<br> Medical Affairs<br> Address: 1100 Campus Rd<br> Princeton, NJ 08540<br> medical.affairs@integra.com<br> </div>
      <div class="center"> <br><br>
         <div class="a1"><b>REQUEST TO INTEGRA MEDICAL AFFAIRS</b></div><br><br><br><br>
      </div>
      <div class="b2">This webform is intended for US Healthcare Professionals only.</div><br> To report a suspected side effect, adverse reaction, or concern about the quality of a Integra Product contact Integra at:<br><br> Phone: 111-222-3333 <br> Email: ABCD@integra.com. <br><br>Do NOT submit on this medical inquiry form. <br><br><br><br>
      <form action="/submit" method="post" class="center" id="healthCareForm"> <br>
         <div class="left"> <label for="geProduct">Product:<span class="mandatory__required" aria-hidden="true">*</span></label><br> <select id="geProduct" name="geProduct" required>
               <option value="option1">Option 1</option>
               <option value="option2">Option 2</option>
               <option value="option3">Option 3</option>
               <option value="option4">Option 4</option>
            </select> <span id="geProduct-error" class="error-message"></span> </div>
         <div class="left"> <label for="requestType">Request Type:<span class="mandatory__required" aria-hidden="true">*</span></label><br> <select id="requestType" name="requestType">
               <option value="option1">Medical Information</option>
               <option value="option2">Applications Training</option>
               <option value="option3">Meeting with Medical Science Liaison</option>
            </select> <span id="requestType-error" class="error-message"></span> </div> <br><br><br> <br><br><br>
         <div class="left"> <label for="professionalDesignation">Professional Designation<span class="mandatory__required" aria-hidden="true">*</span></label><br> <select id="professionalDesignation" name="professionalDesignation">
               <option value="option1">Nurse</option>
               <option value="option2">Pharmacist</option>
               <option value="option3">Physician</option>
               <option value="option4">Other Healthcare Professional</option>
            </select> <span id="professionalDesignation-error" class="error-message"></span> </div>
         <div class="left"> <label for="state">State</label><br> <select id="state" name="state">
               <option value="option1">Option 1</option>
               <option value="option2">Option 2</option>
               <option value="option3">Option 3</option>
               <option value="option4">Option 4</option>
            </select> <span id="state-error" class="error-message"></span> </div> <br><br><br> <br><br><br> <!-- Repeat the above code for dropdowns 2, 3, and 4 -->
			<div>
         <div class="left"> <label for="hcpName">HCP Name<span class="mandatory__required" aria-hidden="true">*</span></label><br> <input type="text" id="hcpName" name="hcpName" maxlength="5" required> <span id="hcpName-error" class="error-message"></span> </div>
         <div class="left"> <label for="hcpEmail">HCP Email<span class="mandatory__required" aria-hidden="true">*</span></label><br> <input type="email" id="hcpEmail" name="text1"> <span id="hcpEmail-error" class="error-message"><br><br><br> </div></div>
         <div class="left"> <label for="facilityAffiliation">Facility<span class="mandatory__required" aria-hidden="true">*</span></label><br> <input type="text" id="facilityAffiliation" name="facilityAffiliation"> <span id="facilityAffiliation-error" class="error-message"></span> </div>
         <div class="left"> <label for="phoneExtension">Phone<span class="mandatory__required" aria-hidden="true">*</span></label><br> <input type="tel" id="phoneExtension" name="phoneExtension" pattern="^[0-9\-]+$" required oninput="if(!this.value.match('^[0-9\-]+$')) this.value='';" maxlength='10' autocomplete='off' onkeyup="numbersonly(this)"> <br><br><span id="phoneExtension-error" class="error-message"><br> </div>
         <div class="left"> <label for="department">Department</label><br> <input type="text" id="department" name="department"><span id="department-error" class="error-message"></span> </div>
         <div class="left"> <label for="address">Address</label><br> <input type="text" id="address" name="address"> <br><br><br> </div>
         <div class="left"> <label for="city">City<span class="mandatory__required" aria-hidden="true">*</span></label><br> <input type="text" id="city" name="city"><span id="city-error" class="error-message"></span> </div>
         <div class="left"> <label for="zip">Zip<span class="mandatory__required" aria-hidden="true">*</span></label><br> <input type="text" id="zip" name="zip" pattern="^[1-9][0-9]*$" required oninput="if(!this.value.match('^[1-9][0-9]*$'))this.value='';" maxlength='10' autocomplete='off' onkeyup="numbersonly(this)"><span id="zip-error" class="error-message"></span> </div><br>&nbsp; <div><br> <label for="querySubmitted"><br>Query submitted by Sales<span class="mandatory__required" aria-hidden="true">*</span></label><br> <select id="querySubmitted" name="querySubmitted">
               <option value="option1">Yes</option>
               <option value="option2">No</option>
            </select> <span id="querySubmitted-error" class="error-message"></span> </div> <br><br><br> <b>Medical Affairs Request:</b> The following must be completed using the Requestor's own words and/or with the Requestor's consent.<br><br>
         <div><br> <label for="message">Describe the specific information requested<span class="mandatory__required" aria-hidden="true">*</span></label><br> <textarea id="message" name="message" rows="10" cols="30"></textarea><span id="message-error" class="error-message"></span> </div><br>&nbsp;<br>
         <div class="o"> I hereby acknowledge that my decision to request this information has been made independently of any INTEGRA influence. The information is for my own and/or my facility&rsquo;s use and will not be further disseminated to third parties without prior written consent of INTEGRA. </div><br>&nbsp;<br> <label for="signature">Signature:</label>
         <div id="signature-pad" class="signature-pad"> <canvas></canvas> <button type="button" id="clear-signature">Clear</button> <input type="hidden" name="signature_data" id="signature_data"> <br> </div><br>&nbsp;<br> <input type="submit" value="Submit" class="s" id="submitBtn">
         <script>
            function numbersonly(input) {
                var filter = /[^0-9]/g;
                input.value = input.value.replace(filter, "");
            }
            
            // Initialize Signature Pad
            var canvas = document.querySelector("canvas");
            var signaturePad = new SignaturePad(canvas);
            
            // Clear Signature
            document.getElementById("clear-signature").addEventListener("click", function () {
                signaturePad.clear();
            });
            
            // Get signature data on form submit
            document.getElementById("submitBtn").addEventListener("click", function (event) {
                event.preventDefault();
                // removeErrorMessages();
                // Validation checks
                if (!validateForm()) {
                    return;
                }
            		const signatureCanvas = document.querySelector("canvas");
            		const signatureData = signaturePad.toDataURL();
                const formData = {
					//newSignatureData : signatureData;
                    healthCareProduct: document.getElementById("geProduct").value,
                    designation: document.getElementById("professionalDesignation").value,
                    hcpEmail: document.getElementById("hcpEmail").value,
                    phone: document.getElementById("phoneExtension").value,
                    address: document.getElementById("address").value,
                    state: document.getElementById("state").value,
                    querySubmit: document.getElementById("querySubmitted").value,
                    requestType: document.getElementById("requestType").value,
                    hcpName: document.getElementById("hcpName").value,
                    facility: document.getElementById("facilityAffiliation").value,
                    department: document.getElementById("department").value,
                    city: document.getElementById("city").value,
                    zip: document.getElementById("zip").value,
                    description: document.getElementById("message").value,
					signature: signatureData,
                };
                console.log(formData);
                fetch("http://localhost:9090/api/v1/healthCare/add", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify(formData),
                })
                    .then((response) => {
                        if (!response.ok) {
                            throw new Error(`HTTP error! Status: ${response.status}`);
                        }
                        return response.json();
                    })
                    .then((data) => {
                        if (data.status === "ok" && data.message === "User Created Successfully") {
                            console.log("User created successfully");
                        } else {
                            throw new Error("Unexpected server response");
                        }
                    })
                    .catch((error) => {
                        console.error("Error:", error.message);
                    });
            });
            
            // Validation function
            function validateForm() {
                 removeErrorMessages(); // Clear existing error messages
                const mandatoryFields = [
                    "geProduct",
                    "requestType",
                    "professionalDesignation",
                    "hcpName",
                    "hcpEmail",
                    "facilityAffiliation",
                    "phoneExtension",
                    "city",
                    "zip",
                    "querySubmitted",
                    "message",
                ];
                let isValid = true;
            
                for (const fieldId of mandatoryFields) {
                    const field = document.getElementById(fieldId);
                    const errorSpan = document.getElementById(`${fieldId}-error`);
            
                    if (!field.value.trim()) {
                        displayErrorMessage(errorSpan, `${getFieldLabel(fieldId)} is a mandatory field and cannot be empty.`);
                        isValid = false;
                    }
                }
            
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                const hcpEmail = document.getElementById("hcpEmail").value;
                const emailErrorSpan = document.getElementById("hcpEmail-error");
                if (!emailRegex.test(hcpEmail)) {
                    displayErrorMessage(emailErrorSpan, "Invalid email format in HCP Email field.");
                    isValid = false;
                }
            
                const phoneRegex = /^[0-9]{10}$/;
                const phoneExtension = document.getElementById("phoneExtension").value;
                const phoneErrorSpan = document.getElementById("phoneExtension-error");
                if (!phoneRegex.test(phoneExtension)) {
                    displayErrorMessage(phoneErrorSpan, "Invalid phone format in Phone field.");
                    isValid = false;
                }
            
                return isValid;
            }
            
            // Function to display error message
             function displayErrorMessage(element, message) {
                    if (element) {
                        element.textContent = message;
                        element.style.display = "block";
                    } else {
                        console.error("Element is null or undefined");
                    }
                }
            
                // Function to remove error messages
                function removeErrorMessages() {
                    const errorSpans = document.querySelectorAll('.error-message');
                    errorSpans.forEach(span => span.textContent = '');
                }
            
                // Function to get field label
                function getFieldLabel(fieldId) {
                    const labelElement = document.querySelector(`label[for="${fieldId}"]`);
                    return labelElement ? labelElement.textContent : fieldId;
                }
         </script>
      </form> <br><br><br>
   </div> <img src="https://sftp.tika.mobi/ftp/2.jpg" style="width:100%;">
</body>

</html>